"use strict";(self.webpackChunk_leap_cosmos_extension=self.webpackChunk_leap_cosmos_extension||[]).push([[3364],{423364:(H,v,t)=>{t.r(v),t.d(v,{default:()=>Z});var w=t(395362),m=t(339279),j=t.n(m),R=t(294184),T=t.n(R),K=t(676072),W=t(133525),M=t(892742),u=t(94608),B=t(501937),k=t(634680),N=t(840575),_=t(508181),e=t(202784),C=t(410289),D=t(610675),d=t(15815),S=t(472565),s=t.n(S),b=t(128844),c=t(164012);function L(o){const E=(0,m.useTheme)().theme===m.ThemeName.DARK;return o.loading?e.createElement(M.Z,null,e.createElement("div",{className:"flex flex-col items-center justify-center h-full"},e.createElement(b.Z,null))):e.createElement(M.Z,{className:"!h-screen !max-h-[680px]"},e.createElement("div",{className:"flex h-[72px] w-[400px] items-center px-7 mt-[8px]"},e.createElement("img",{className:T()({"w-[40px] h-[40px]":(0,d.l)(),"h-[30px]":!(0,d.l)()}),src:(0,d.l)()?_.r.Logos.CompassCircle:E?_.r.Logos.LeapDarkMode:_.r.Logos.LeapLightMode}),(0,d.l)()&&e.createElement("div",{className:"font-black inline-block text-2xl text-gray-900 dark:text-white-100 ml-2"},"COMPASS")),e.createElement("form",{onSubmit:o.onSubmit,className:"relative flex p-[48px] items-center justify-center flex-col h-[504px]"},e.createElement("div",{className:"dark:bg-gray-900 bg-white-100 rounded-[16px] mb-4"},e.createElement("div",{style:{fontSize:48},className:"p-[12px] material-icons-round text-gray-400 dark:text-white-100"},"lock")),e.createElement(u.Z,{size:"lg",className:"dark:text-white-100 text-gray-900 font-bold mb-1"},"Welcome back"),e.createElement(u.Z,{size:"md",color:"text-gray-400 font-bold mb-8","data-testing-id":"login-enter-your-password-ele"},"Enter your password to unlock wallet"),e.createElement("div",{className:"flex w-[304px] justify-center shrink"},e.createElement(m.Input,{autoFocus:!0,type:"password",placeholder:"Enter password",isErrorHighlighted:o.errorHighlighted,onChange:g=>o.onChange(g),"data-testing-id":"login-input-enter-password"})),e.createElement("div",{className:"h-[64px]"},o.errorHighlighted&&e.createElement(u.Z,{size:"sm",color:"text-red-300 mt-[16px]","data-testing-id":"login-error-text"},"Incorrect password. Please try again")),e.createElement("div",{className:"flex w-[304px] shrink"},e.createElement(m.Buttons.Generic,{size:"normal",onClick:o.onClick,color:(0,d.l)()?D.w.compassPrimary:D.w.osmosisPrimary,"data-testing-id":"btn-unlock-wallet",disabled:o.unlockLoader},o.unlockLoader?e.createElement(K.Z,null):"Unlock wallet")),e.createElement("div",{className:"p-[28px]",onClick:o.onClick1},e.createElement(u.Z,{size:"md",className:"font-semibold hover:underline cursor-pointer"},"Forgot Password?"))))}function Z(){const o=(0,k.a7)(),r=(0,C.TH)(),[E,g]=(0,e.useState)(""),i=(0,C.s0)(),l=(0,B.aC)(),O=(0,N.tN)(),[V,z]=(0,e.useState)(!1),[y,f]=(0,e.useState)(!1),[I,p]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(!l)return;const a=`${o}-send-address`;s().storage.local.get([a]).then(n=>{if(!l.locked){const P=n[a]?"/send":r.state?.from?.pathname??"/home";i(P,{state:{from:"login"},replace:!0})}})},[o,l,r.state,i]),(0,e.useEffect)(()=>{s().storage.local.get([c.pV,w.rU]).then(a=>{if(!a[c.pV]&&!a[w.rU]){const n=s().extension.getViews({type:"tab"});s().extension.getViews({type:"popup"}).findIndex(A=>A===window)!==-1?s().tabs.create({url:s().runtime.getURL("index.html#/onboarding")}):(n.filter(x=>x!==window).forEach(x=>x.close()),i("/onboarding",{state:{from:"login"},replace:!0}))}})},[]),(0,e.useEffect)(()=>{const a=async()=>{new URLSearchParams(r.search).has("close-on-login")||r.state?.from.search.includes("unlock-to-approve")?s().runtime.sendMessage({type:"user-logged-in",payload:{status:"failed"}}):await s().storage.local.set({[c.u1]:{error:"Request rejected"}}),setTimeout(()=>{s().storage.local.remove(c.u1)},50)};return s().storage.local.get(c.AI).then(async n=>{n[c.AI]&&(z(!0),await s().storage.local.remove(c.u1))}),window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}},[]);const h=(0,e.useCallback)(async()=>{if(E){p(!0);try{await l.signin(E,()=>{if(O(),new URLSearchParams(r.search).has("close-on-login")){s().runtime.sendMessage({type:"user-logged-in",payload:{status:"success"}}),window.close();return}const n=r.state?.from?.pathname;n&&n.includes("onboarding")&&l&&!l.noAccount?i("/home",{state:{from:"login"},replace:!0}):i(n??"/home",{state:{from:"login"},replace:!0}),p(!1)})}catch{f(!0),p(!1)}}},[l,r.state,i,E,O]),U=(0,e.useCallback)(a=>{a.preventDefault(),h()},[h]);return s().extension.getViews({type:"popup"}).length===0&&!V?e.createElement(W.Z,null,e.createElement("div",{className:"absolute top-0 flex h-full w-1/2 z-5 justify-center items-center"},e.createElement("div",{className:"dark:shadow-sm shadow-xl dark:shadow-gray-700"},e.createElement(L,{unlockLoader:I,loading:l.loading,onSubmit:U,errorHighlighted:y,onChange:a=>{f(!1),g(a.target.value)},onClick:h,onClick1:()=>{s().extension.getViews({type:"popup"}).length===0?i("/forgotPassword"):window.open(s().runtime.getURL("index.html#/forgotPassword"))}})))):e.createElement(L,{unlockLoader:I,loading:l.loading,onSubmit:U,errorHighlighted:y,fullHeight:!0,onChange:a=>{f(!1),g(a.target.value)},onClick:h,onClick1:()=>{s().extension.getViews({type:"popup"}).length===0?i("/forgotPassword"):window.open(s().runtime.getURL("index.html#/forgotPassword"))}})}}}]);
